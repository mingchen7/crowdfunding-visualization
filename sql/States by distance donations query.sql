SELECT PP.PROJECTID,
PP.TEACHER_ACCTID,
PP.SCHOOLID,
PP.SCHOOL_NCESID,
PP.SCHOOL_LATITUDE,
PP.SCHOOL_LONGITUDE,
PP.SCHOOL_CITY,
PP.SCHOOL_STATE,
PP.SCHOOL_ZIP,
PP.SCHOOL_METRO,
PP.SCHOOL_DISTRICT,
PP.SCHOOL_COUNTY,
PP.SCHOOL_CHARTER,
PP.SCHOOL_MAGNET,
PP.SCHOOL_YEAR_ROUND,
PP.SCHOOL_NLNS,
PP.SCHOOL_KIPP,
PP.SCH_CHART_READ_PROM,
PP.TEACHER_PREFIX,
PP.TEACHER_TEACH_FOR_AMERICA,
PP.TEACH_NY_FELLOW,
PP.PRIMARY_FOCUS_SUBJECT,
PP.PRIMARY_FOCUS_AREA,
PP.SECONDARY_FOCUS_SUBJECT,
PP.SECONDARY_FOCUS_AREA,
PP.RESOURCE_TYPE,
PP.POVERTY_LEVEL,
PP.GRADE_LEVEL,
PP.VENDOR_SHIPPING_CHARGES,
PP.SALES_TAX,
PP.PMT_PROC_CHARGE,
PP.FULFIL_LABOR_MAT,
PP.TOT_PRICE_EXCL_OPT_SUP,
PP.TOT_PRICE_INCL_OPT_SUP,
PP.STUDENTS_REACHED,
PP.TOTAL_DONATIONS,
PP.NUM_DONORS,
PP.ELIG_DOB_UR_IMP_MAT,
PP.ELIG_ALM_HOME_MAT,
PP.FUNDING_STATUS,
PP.DATE_POSTED,
PP.DATE_COMPLETED,
PP.DATE_THNK_U_PCKT,
PP.DATE_EXPIRATION,
PP.DT_POSTED,
PP.DT_COMPLETED,
PP.DT_THANK_PKT,
PP.DT_EXPIRATION,
DD.DONOR_STATE,
SUM(DD.DNTN_TOTAL)   AS DONATION_AMOUNT,
SMPD.DISTANCE
FROM PROJECTS PP
INNER JOIN DONATIONS DD
ON PP.PROJECTID = DD.PROJECTID
INNER JOIN 
STATE_MIN_PATH_DIST SMPD
ON PP.SCHOOL_STATE = SMPD.STATE1
AND DD.DONOR_STATE = SMPD.STATE2
WHERE PP.DT_COMPLETED >= '01-JAN-2014'
AND PP.DT_COMPLETED <= '31-DEC-2014'
GROUP BY PP.PROJECTID,
PP.TEACHER_ACCTID,
PP.SCHOOLID,
PP.SCHOOL_NCESID,
PP.SCHOOL_LATITUDE,
PP.SCHOOL_LONGITUDE,
PP.SCHOOL_CITY,
PP.SCHOOL_STATE,
PP.SCHOOL_ZIP,
PP.SCHOOL_METRO,
PP.SCHOOL_DISTRICT,
PP.SCHOOL_COUNTY,
PP.SCHOOL_CHARTER,
PP.SCHOOL_MAGNET,
PP.SCHOOL_YEAR_ROUND,
PP.SCHOOL_NLNS,
PP.SCHOOL_KIPP,
PP.SCH_CHART_READ_PROM,
PP.TEACHER_PREFIX,
PP.TEACHER_TEACH_FOR_AMERICA,
PP.TEACH_NY_FELLOW,
PP.PRIMARY_FOCUS_SUBJECT,
PP.PRIMARY_FOCUS_AREA,
PP.SECONDARY_FOCUS_SUBJECT,
PP.SECONDARY_FOCUS_AREA,
PP.RESOURCE_TYPE,
PP.POVERTY_LEVEL,
PP.GRADE_LEVEL,
PP.VENDOR_SHIPPING_CHARGES,
PP.SALES_TAX,
PP.PMT_PROC_CHARGE,
PP.FULFIL_LABOR_MAT,
PP.TOT_PRICE_EXCL_OPT_SUP,
PP.TOT_PRICE_INCL_OPT_SUP,
PP.STUDENTS_REACHED,
PP.TOTAL_DONATIONS,
PP.NUM_DONORS,
PP.ELIG_DOB_UR_IMP_MAT,
PP.ELIG_ALM_HOME_MAT,
PP.FUNDING_STATUS,
PP.DATE_POSTED,
PP.DATE_COMPLETED,
PP.DATE_THNK_U_PCKT,
PP.DATE_EXPIRATION,
PP.DT_POSTED,
PP.DT_COMPLETED,
PP.DT_THANK_PKT,
PP.DT_EXPIRATION,
DD.DONOR_STATE,
SMPD.DISTANCE